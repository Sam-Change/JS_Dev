<!-- jsTestIndex -->
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>jsTestIndex</title>
</head>

<body>
  <!--畫面組成-->
  <!--span id(document.getElementById)為web端儲存資料欄位名稱，會一直撈此欄位資料當欄位值改變就會更新?-->
  <table class="screenWidth border">
    <thead>
        <tr>
            <th colspan="2">SoftMobile TestWebView0629</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="screenWidth20% border textFormat">resEncData</td>
            <td class="screenWidth80% border textFormat" id="resEncData"></td>
        </tr>
        <tr>
            <td class="screenWidth20% border textFormat">resPGData</td>
            <td class="screenWidth80% border textFormat" id="resPGData"></td>
        </tr>
        <tr>
            <td class="screenWidth20% border textFormat">receiveOCR</td>
            <td class="screenWidth80% border textFormat" id="receiveOCR"></td>
        </tr>
        <tr>
            <td class="screenWidth20% border textFormat">receiveVerify</td>
            <td class="screenWidth80% border textFormat" id="receiveVerify"></td>
        </tr>
        <tr>
            <td class="screenWidth20% border textFormat">receiveTransactionAuth</td>
            <td class="screenWidth80% border textFormat" id="receiveTransactionAuth"></td>
        </tr>
        <tr>
            <td class="screenWidth20% border textFormat">receiveGetAPPAuthdata</td>
            <td class="screenWidth80% border textFormat" id="receiveGetAPPAuthdata"></td>
        </tr>
        <tr>
            <td><button onclick="goHome()">goHome</button><td>
        </tr>
        <tr>
            <td><button onclick="closeFunc()">closeFunc</button><td>
        </tr>
        <tr> 
            <td><button onclick="getEnCrydata()">getEnCrydata</button><td>
        </tr>
        <tr>
            <td><button onclick="getPagedata()">getPagedata</button><td>
        </tr>
        <tr>
            <td><button onclick="onOCR()">onOCR</button><td>
        </tr>
        <tr>
            <td><button onclick="onVerification()">onVerification</button><td>
        </tr>
        <tr>
            <td><button onclick="transactionAuth()">transactionAuth</button><td>
        </tr>
        <tr> 
            <td><button onclick="getAPPAuthdata()">getAPPAuthdata</button><td>
        </tr>
        <tr>
            <td><button onclick="startFuncToB00600()">startFunc更多</button><td>
        </tr>
        <tr>    
            <td><button onclick="startFuncToT00100()">startFunc個人化設定</button><td>
        </tr>
        <tr>
            <td><button onclick="openPopWebView()">openPopWebView</button><td>
        </tr>
        <tr> 
            <td><button onclick="setShareText()">setShareText</button><td>
        </tr>
        
    </tbody>
  </table>
  
  <script>
    var ideviceCheck = isiOSDevice()

    function isiOSDevice() {
      const mobileDevice = ['iPhone', 'iPad', 'iPod']
      let isMobileDevice = mobileDevice.some(e => navigator.userAgent.match(e))
      return isMobileDevice
    }

    let packet_goHome = {
      "name": "goHome",
    }

    function goHome() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_goHome);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          jstoapp.goHome();
        }
      }
    }

    let packet_closeFunc = {
      "name": "closeFunc",
    }

    function closeFunc() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_closeFunc);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          jstoapp.closeFunc();
        }
      }
    }

    let packet_getEnCrydataData = {
      "callback": "resEncData",
    }

    let packet_getEnCrydata = {
      "name": "getEnCrydata",
      "data": JSON.stringify(packet_getEnCrydataData),
    }

    function getEnCrydata() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_getEnCrydata);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_getEnCrydataData);
          jstoapp.getEnCrydata(action);
        }
      }
    }

    let packet_getPagedataData = {
      "callback": "resPGData",
    }

    let packet_getPagedata = {
      "name": "getPagedata",
      "data": JSON.stringify(packet_getPagedataData),
    }

    function getPagedata() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_getPagedata);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_getPagedataData);
          jstoapp.getPagedata(action);
        }
      }
    }

    let packet_onOCRData = {
      "ocrType": "1",
      "callback":"receiveOCR",
    }

    let packet_onOCR = {
      "name": "onOCR",
      "data": JSON.stringify(packet_onOCRData),
    }

    function onOCR() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_onOCR);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_onOCRData);
          jstoapp.onOCR(action);
        }
      }
    }

    let packet_onVerificationData = {
      "type": "1",
      "callback":"receiveVerify",
      "otpType":"2",
    }

    let packet_onVerification = {
      "name": "onVerification",
      "data": JSON.stringify(packet_onVerificationData),
    }

    function onVerification() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_onVerification);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_onVerificationData);
          jstoapp.onVerification(action);
        }
      }
    }

    let packet_transactionAuthData = {
      "callback":"receiveTransactionAuth",
    }

    let packet_transactionAuth = {
      "name": "transactionAuth",
      "data": JSON.stringify(packet_transactionAuthData),
    }

    function transactionAuth() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_transactionAuth);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_transactionAuthData);
          jstoapp.transactionAuth(action);
        }
      }
    }

    let packet_getAPPAuthdataData = {
      "callback":"receiveGetAPPAuthdata",
    }

    let packet_getAPPAuthdata = {
      "name": "getAPPAuthdata",
      "data": JSON.stringify(packet_getAPPAuthdataData),
    }

    function getAPPAuthdata() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_getAPPAuthdata);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_getAPPAuthdataData);
          jstoapp.getAPPAuthdata(action);
        }
      }
    }




    

    let packet_startFuncD00200Data = {
      "funcID": "D00200",
      "funcParams": "vbwy9g809-i403kgrwhbivuhew0j9gv",
      "keepData": "83579809g35iuhruibndoivmr",
    }

    let packet_startFuncD00200 = {
      "name": "startFunc",
      "data": JSON.stringify(packet_startFuncD00200Data),
    }

    function startFuncD00200() { 
      if (ideviceCheck) {
        var action = JSON.stringify(packet_startFuncD00200);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_startFuncD00200Data);
          jstoapp.startFunc(action);
        }
      }
    }

    let packet_startFuncT00100Data = {
      "funcID": "T00100",
      "funcParams": "vbwy9g809-i403kgrwhbivuhew0j9gv",
      "keepData": "83579809g35iuhruibndoivmr",
    }

    let packet_startFuncT00100 = {
      "name": "startFunc",
      "data": JSON.stringify(packet_startFuncT00100Data),
    }

    function startFuncT00100() { 
      if (ideviceCheck) {
        var action = JSON.stringify(packet_startFuncT00100);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_startFuncT00100Data);
          jstoapp.startFunc(action);
        }
      }
    }

    let packet_openPopWebViewData = {
      "url": "https://sam-change.github.io/JS_Dev/popweb.html",
    }

    let packet_openPopWebView = {
      "name": "openPopWebView",
      "data": JSON.stringify(packet_openPopWebViewData),
    }

    function openPopWebView() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_openPopWebView);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_openPopWebViewData);
          jstoapp.openPopWebView(action);
        }
      }
    }

    let packet_setShareTextData = {
      "webtext": "大谷翔平　3試合ぶり17号ソロ！3回に右腕クエトから中越えアーチ、トラウトと今季4度目のアベック弾",
    }

    let packet_setShareText = {
      "name": "setShareText",
      "data": JSON.stringify(packet_setShareTextData),
    }

    function setShareText() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_setShareText);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_setShareTextData);
          jstoapp.setShareText(action);
        }
      }
    }

    // 收JS
    function resEncData(data) {
      document.getElementById("resEncData").innerText = "收到Crydata:" + data["Crydata"] + ", Enivec:" + data["Enivec"];
    }

    function resPGData(data) {
      document.getElementById("resPGData").innerText = "收到funcParams:" + JSON.stringify(data["funcParams"]) + ", keepData:" + JSON.stringify(data["keepData"]);
    }

    function receiveOCR(data) {
      document.getElementById("receiveOCR").innerText = "收到rtcode:" + data["rtcode"] + ", rtmsg:" + data["rtmsg"] + ", data:" + JSON.stringify(data["data"]);
    }

    function receiveVerify(data) {
      document.getElementById("receiveVerify").innerText = "收到Type:" + data["Type"] + ", signature:" + data["signature"] + ", Mima:" + data["Mima"] + ", otpType:" + data["otpType"] + ", rtcode:" + data["rtcode"] + ", rtmsg:" + data["rtmsg"];
    }

    function receiveTransactionAuth(data) {
      document.getElementById("receiveTransactionAuth").innerText = "收到result:" + data["result"] + ", message:" + data["message"];
    }

    function receiveGetAPPAuthdata(data) {
      document.getElementById("receiveGetAPPAuthdata").innerText = "收到auth:" + data["auth"];
    }
  </script>
</body>
  
<style>
  .textFormat {
    font-size: 14;
  }

  .screenWidth {
    width: screen.width;
  }
  
  .screenWidth20% {
    width: screen.width*20%;
  }

  .screenWidth50% {
    width: screen.width*50%;
  }

  .screenWidth80% {
    width: screen.width*80%;
  }

  .border {
    border: 1px solid #333;
  }

</style>
  
</html>
