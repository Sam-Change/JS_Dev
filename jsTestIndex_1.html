<!-- jsTestIndex -->
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>jsTestIndex</title>
</head>

<body>
  <!--畫面組成-->
  <!--span id(document.getElementById)為web端儲存資料欄位名稱，會一直撈此欄位資料當欄位值改變就會更新?-->
  <table class="screenWidth border">
    <thead>
        <tr>
            <th colspan="2">SoftMobile TestWebView0629</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="border: 1px solid #333;width: 20%;">resEncData</td>
            <td style="border: 1px solid #333;width: 80%;" id="resEncData"></td>
        </tr>
        <tr>
            <td style="border: 1px solid #333;width: 20%;">resPGData</td>
            <td style="border: 1px solid #333;width: 80%;" id="resPGData"></td>
        </tr>
        <tr>
            <td style="border: 1px solid #333;width: 20%;">receiveOCR</td>
            <td style="border: 1px solid #333;width: 80%;" id="receiveOCR"></td>
        </tr>
        <tr>
            <td style="border: 1px solid #333;width: 20%;">receiveVerify</td>
            <td style="border: 1px solid #333;width: 80%;" id="receiveVerify"></td>
        </tr>
        <tr>
            <td><button class="screenWidth50%" onclick="goHome()">goHome</button><td>
        </tr>
        <tr>
            <td><button class="screenWidth" onclick="closeFunc()">closeFunc</button><td>
        </tr>
        <tr>
            <td><button style="width: 50%;" onclick="onVerification()">onVerification</button><td>
            <td><button style="width: 50%;" onclick="onOCR()">onOCR</button><td>
        </tr>
        <tr>
            <td><button style="width: 50%;" onclick="startFuncToB00600()">startFunc更多</button><td>
            <td><button style="width: 50%;" onclick="startFuncToT00100()">startFunc個人化設定</button><td>
        </tr>
        <tr>
            <td><button style="width: 50%;" onclick="openPopWebView()">openPopWebView</button><td>
            <td><button style="width: 50%;" onclick="setShareText()">setShareText</button><td>
        </tr>
        <tr>
            <td><button style="width: 50%;" onclick="getPagedata()">getPagedata</button><td>
            <td><button style="width: 50%;" onclick="getEnCrydata()">getEnCrydata</button><td>
            <td><input type="button" value="test" class="btn"/></td>
        </tr>
    </tbody>
  </table>


<!--   <button class="button_style button_y70" onclick="setAuthdata()">網頁更新APP個人識別碼setAuthdata</button>
  <button class="button_style button_y70 button_x50" onclick="getAPPAuthdata()">網頁取得APP個人識別碼getAPPAuthdata</button> -->
  
  <script>


    var ideviceCheck = isiOSDevice()

    function isiOSDevice() {
      const mobileDevice = ['iPhone', 'iPad', 'iPod']
      let isMobileDevice = mobileDevice.some(e => navigator.userAgent.match(e))
      return isMobileDevice
    }

    let packet_goHome = {
      "name": "goHome",
    }

    function goHome() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_goHome);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          jstoapp.goHome();
        }
      }
    }

    let packet_closeFunc = {
      "name": "closeFunc",
    }

    function closeFunc() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_closeFunc);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          jstoapp.closeFunc();
        }
      }
    }

    let packet_onVerificationData = {
      "type": "1",
      "callback":"receiveVerify",
      "otpType":"2",
    }

    let packet_onVerification = {
      "name": "onVerification",
      "data": JSON.stringify(packet_onVerificationData),
    }

    function onVerification() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_onVerification);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_onVerificationData);
          jstoapp.onVerification(action);
        }
      }
    }

    let packet_onOCRData = {
      "ocrType": "1",
      "callback":"receiveOCR",
    }

    let packet_onOCR = {
      "name": "onOCR",
      "data": JSON.stringify(packet_onOCRData),
    }

    function onOCR() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_onOCR);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_onOCRData);
          jstoapp.onOCR(action);
        }
      }
    }

    let packet_startFuncD00200Data = {
      "funcID": "D00200",
      "funcParams": "vbwy9g809-i403kgrwhbivuhew0j9gv",
      "keepData": "83579809g35iuhruibndoivmr",
    }

    let packet_startFuncD00200 = {
      "name": "startFunc",
      "data": JSON.stringify(packet_startFuncD00200Data),
    }

    function startFuncD00200() { 
      if (ideviceCheck) {
        var action = JSON.stringify(packet_startFuncD00200);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_startFuncD00200Data);
          jstoapp.startFunc(action);
        }
      }
    }

    let packet_startFuncT00100Data = {
      "funcID": "T00100",
      "funcParams": "vbwy9g809-i403kgrwhbivuhew0j9gv",
      "keepData": "83579809g35iuhruibndoivmr",
    }

    let packet_startFuncT00100 = {
      "name": "startFunc",
      "data": JSON.stringify(packet_startFuncT00100Data),
    }

    function startFuncT00100() { 
      if (ideviceCheck) {
        var action = JSON.stringify(packet_startFuncT00100);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_startFuncT00100Data);
          jstoapp.startFunc(action);
        }
      }
    }

    let packet_openPopWebViewData = {
      "url": "https://sam-change.github.io/JS_Dev/popweb.html",
    }

    let packet_openPopWebView = {
      "name": "openPopWebView",
      "data": JSON.stringify(packet_openPopWebViewData),
    }

    function openPopWebView() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_openPopWebView);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_openPopWebViewData);
          jstoapp.openPopWebView(action);
        }
      }
    }

    let packet_setShareTextData = {
      "webtext": "https://sam-change.github.io/JS_Dev/popweb.html",
    }

    let packet_setShareText = {
      "name": "setShareText",
      "data": JSON.stringify(packet_setShareTextData),
    }

    function setShareText() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_setShareText);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_setShareTextData);
          jstoapp.setShareText(action);
        }
      }
    }

    let packet_getPagedataData = {
      "callback": "resPGData",
    }

    let packet_getPagedata = {
      "name": "getPagedata",
      "data": JSON.stringify(packet_getPagedataData),
    }

    function getPagedata() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_getPagedata);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_getPagedataData);
          jstoapp.getPagedata(action);
        }
      }
    }
    
    let packet_getEnCrydataData = {
      "callback": "resEncData",
    }

    let packet_getEnCrydata = {
      "name": "getEnCrydata",
      "data": JSON.stringify(packet_getEnCrydataData),
    }

    function getEnCrydata() {
      if (ideviceCheck) {
        var action = JSON.stringify(packet_getEnCrydata);
        window.webkit.messageHandlers.jstoapp.postMessage(action);
      }
      else {
        if (jstoapp) {
          var action = JSON.stringify(packet_getEnCrydataData);
          jstoapp.getEnCrydata(action);
        }
      }
    }



    // 收JS
    function receiveVerify(data) {
      document.getElementById("receiveVerify").innerText = "收到:" + data;
    }

    function receiveOCR(data) {
      document.getElementById("receiveOCR").innerText = "收到:" + data;
    }

    function resPGData(data) {
      document.getElementById("resPGData").innerText = "收到:" + data;
    }

    function resEncData(data) {
      document.getElementById("resEncData").innerText = "收到Enivec:" + data["Enivec"] + ", Crydata:" + data["Crydata"];
    }

  </script>
</body>
  
<style>
  .screenWidth {
    width: screen.width;
  }
  
  .screenWidth50% {
    width: screen.width*50%;
  }

  .border {
    border: 1px solid #333;
  }

</style>
  
</html>
